<!doctype html>
<html lang="en">
 
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      Идем в машинное отделение. &middot; AndreyMelnikov.MyBlog
    
  </title>

  <link rel="stylesheet" href="/styles.css">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-precomposed.ico" type="image/vnd.microsoft.icon">
  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico?">
  <link rel="alternate" type="application/atom+xml" title="AndreyMelnikov.MyBlog" href="/atom.xml">


  <!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Идем в машинное отделение." />
<meta name="author" content="Andrey Melnikov" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Изучая языки программирования (в школе – Pascal, в университете, в рамках образовательной программы – C++, на данный момент - Python), я всегда задавался вопросом: “а как оно все происходит там, уровнем ниже, в машинном отделении, так сказать?” Ведь одно дело учить синтаксис и команды высокоуровневого языка программирования интуитивно понятные человеку, а другое – хотя бы в общих чертах представлять, как все устроено там, “под капотом”. Если мы спустимся на “этаж” ниже от привычного нам уровня приложений, с понятным нам интерфейсом, то первым, в чем предстоит нам разобраться – это взаимодействие памяти и процессора. Конечно, погружаться очень глубоко в данный вопрос, в рамках данной статьи, я не стану, но в общих чертах попробую описать, как понимаю это я. Допустим, мы написали код некоторой программы. Наш код скомпилировался в исполняемый файл (.EXE для семейства ОС Windows). Структуру готового исполняемого файла я привел ниже:" />
<meta property="og:description" content="Изучая языки программирования (в школе – Pascal, в университете, в рамках образовательной программы – C++, на данный момент - Python), я всегда задавался вопросом: “а как оно все происходит там, уровнем ниже, в машинном отделении, так сказать?” Ведь одно дело учить синтаксис и команды высокоуровневого языка программирования интуитивно понятные человеку, а другое – хотя бы в общих чертах представлять, как все устроено там, “под капотом”. Если мы спустимся на “этаж” ниже от привычного нам уровня приложений, с понятным нам интерфейсом, то первым, в чем предстоит нам разобраться – это взаимодействие памяти и процессора. Конечно, погружаться очень глубоко в данный вопрос, в рамках данной статьи, я не стану, но в общих чертах попробую описать, как понимаю это я. Допустим, мы написали код некоторой программы. Наш код скомпилировался в исполняемый файл (.EXE для семейства ОС Windows). Структуру готового исполняемого файла я привел ниже:" />
<link rel="canonical" href="http://localhost:4000/2020/02/17/go-to-stage-down/" />
<meta property="og:url" content="http://localhost:4000/2020/02/17/go-to-stage-down/" />
<meta property="og:site_name" content="AndreyMelnikov.MyBlog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-02-17T00:00:00+03:00" />
<script type="application/ld+json">
{"headline":"Идем в машинное отделение.","dateModified":"2020-02-17T00:00:00+03:00","datePublished":"2020-02-17T00:00:00+03:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/02/17/go-to-stage-down/"},"url":"http://localhost:4000/2020/02/17/go-to-stage-down/","author":{"@type":"Person","name":"Andrey Melnikov"},"description":"Изучая языки программирования (в школе – Pascal, в университете, в рамках образовательной программы – C++, на данный момент - Python), я всегда задавался вопросом: “а как оно все происходит там, уровнем ниже, в машинном отделении, так сказать?” Ведь одно дело учить синтаксис и команды высокоуровневого языка программирования интуитивно понятные человеку, а другое – хотя бы в общих чертах представлять, как все устроено там, “под капотом”. Если мы спустимся на “этаж” ниже от привычного нам уровня приложений, с понятным нам интерфейсом, то первым, в чем предстоит нам разобраться – это взаимодействие памяти и процессора. Конечно, погружаться очень глубоко в данный вопрос, в рамках данной статьи, я не стану, но в общих чертах попробую описать, как понимаю это я. Допустим, мы написали код некоторой программы. Наш код скомпилировался в исполняемый файл (.EXE для семейства ОС Windows). Структуру готового исполняемого файла я привел ниже:","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>


  <body>
	<table>
	<p></p>
	</table>
    <div class="container content">
	
      <header class="masthead">
        <h3 class="masthead-title">
          <a href="/" title="Home">AndreyMelnikov.MyBlog</a>
          <small>   # мой блог: IT-марафон.</small>
        </h3>
		<p><img src="/image/my_avatar.jpeg"</p>
      </header>

      <main>
        <article class="post">
  <h1 class="post-title">Идем в машинное отделение.</h1>
  <time datetime="2020-02-17T00:00:00+03:00" class="post-date">17 Feb 2020</time>
  <p><img src="/image/machine4.JPG" alt="" />
Изучая языки программирования (в школе – Pascal, в университете, в рамках образовательной программы – C++, на данный момент - Python), я всегда задавался вопросом: “а как оно все происходит там, уровнем ниже, в машинном отделении, так сказать?” Ведь одно дело учить синтаксис и команды высокоуровневого языка программирования интуитивно понятные человеку, а другое – хотя бы в общих чертах представлять, как все устроено там, “под капотом”. 
Если мы спустимся на “этаж” ниже от привычного нам уровня приложений, с понятным нам интерфейсом, то первым, в чем предстоит нам разобраться – это взаимодействие памяти и процессора. Конечно, погружаться очень глубоко в данный вопрос, в рамках данной статьи, я не стану, но в общих чертах попробую описать, как понимаю это я. 
Допустим, мы написали код некоторой программы. Наш код скомпилировался в <strong>исполняемый файл</strong> (.EXE для семейства ОС Windows). Структуру готового исполняемого файла я привел ниже:</p>

<p><img src="/image/exe-struct.jpg" alt="" /></p>

<p>Как мы видим, EXE файл представляет собой несколько сегментов с разным назначением. Данная структура делит нашу программу на сегмент данных и сегмент кода.<br />
<strong>Память</strong> (ОЗУ) – это последовательность байт. Доступ к памяти (ячейкам) может осуществляться как к одному непрерывному массиву (модель <strong>flat</strong>), или как к нескольким массивам (<strong>сегментированная модель</strong>).
Итак, что же происходит при запуске программы? Операционная система (ОС) выделяет необходимый объем памяти. Другими словами – создается <strong>процесс</strong>, то есть выделяются и разграничиваются ресурсы. Затем ОС загружает в выделенную область памяти нашу программу, которая представляет из себя, как мы уже знаем, сегменты данных и команд (инструкций). Далее происходит передача управления нашей программе, то есть выполнение инструкций. Другими словами, создается <strong>поток</strong>.<br />
Поток использует ресурсы процесса и определяет последовательность исполнения кода в соответствующем сегменте.</p>

<p><img src="/image/flow.jpg" alt="" />
Внутри одного процесса может быть несколько потоков и выполняться они могут параллельно. Например, всем известная функция main() запускает главный поток. Остальные потоки запускаются (создаются) при помощи других функций по мере необходимости и усмотрению программиста при написании кода.
При загрузке процесса в ОЗУ формируется адресное пространство этого процесса, которое состоит из различных сегментов. Ниже на схеме, я попытался доступно это отразить:</p>

<p><img src="/image/memory_process.jpg" alt="" /></p>

<p>Теперь мы немного представляем, как устроена организация ресурсов памяти выделенной под конкретный процесс. Но как происходят непосредственно операции - вычисления над данными, которые там хранятся? Иначе говоря, мы рассмотрели структуру склада данных, но еще не видели организацию цеха по переработке этих данных :) Представленная ниже схема – архитектура ЭВМ, она очень упрощена для удобства понимания в рамках данной статьи:</p>

<p><img src="/image/EVM-architekt.jpg" alt="" /></p>

<p>Итак, наша программа записывается в ОЗУ, далее она частями считывается и значения, которые требуют обработки (каких либо вычислений), посредством системной шины, поступают в <strong>кэш-память</strong> процессора (CPU). Да, помимо ОЗУ, у процессора есть своя память, которая намного меньше по объему, но гораздо (во много раз) быстрее ОЗУ. Так сказать, процессор имеет свой собственный сверхбыстрый буфер, имеющий разные уровни (L1, L2, L3). Дальнейшие операции производятся при помощи регистров процессора. Дело в том, что процессор работает только с собственными регистрами. Напрямую с ОЗУ он не взаимодействует. Сегмент кода (инструкций) из нашей программы, говорит процессору какую операцию необходимо применить над значениями, которые были записаны в соответствующие регистры. Все идущее ниже по тексту, будет рассмотрено на примере архитектуры процессоров семейства <strong>x86</strong>.</p>

<p><strong>Регистры процессора</strong> – специальное место (ячейки памяти внутри процессора), где хранятся значения, записанные из программы (ОЗУ), при помощи системной шины, для которых необходимо сделать какие-либо вычисления.
После включения, процессор находится в режиме <strong>реальной адресации</strong>. Это режим, при котором любому процессу доступна вся память компьютера. При загрузке операционной системы, ОС переводит процессор в <strong>защищенный режим</strong>, при котором доступ к ресурсам для различных процессов разграничиваются и контролируются самой ОС.
Бит – минимальная единица информации, которой оперирует процессор. 1 байт = 8 бит и это составляет 1 “слово”. Итак, 1 слово = 8 бит = 1 байт или 2^8 = 256 значений. Существуют также двойные слова и т.д.<br />
2 слова = 2^16 = 65 535 <br />
3 слова = 2^32 = 4 294 967 295<br />
Байт, слово, двойное слово – это основные типы данных процессора. Для представления знака (отрицательное или положительное число) используется инверсия всех бит, а затем ко всем полученным битам прибавляется 1.
Для операций с плавающей точкой используется специальное устройство (<strong>FPU</strong>) внутри основного процессора с собственными регистрами и набором команд.</p>

<p>По назначению регистры процессора различаются на:</p>
<ul>
  <li>аккумулятор — используется для хранения промежуточных результатов арифметических и логических операций и инструкций ввода-вывода;</li>
  <li>флаговые — хранят признаки результатов арифметических и логических операций;</li>
  <li>общего назначения — хранят операнды арифметических и логических выражений, индексы и адреса;</li>
  <li>индексные — хранят индексы исходных и целевых элементов массива;</li>
  <li>указательные — хранят указатели на специальные области памяти (указатель текущей операции, указатель базы, указатель стека);</li>
  <li>сегментные — хранят адреса и селекторы сегментов памяти;</li>
  <li>управляющие — хранят информацию, управляющую состоянием процессора, а также адреса системных таблиц.</li>
</ul>

<p>Кроме того, процессор содержит наборы команд и инструкций. Например, расширения <strong>MMX</strong> - это встроенный набор дополнительных инструкций для более эффективной работы с большим потоком данных (изображения, видео, звук). По сути, это несколько новых типов данных, регистров и команд для повышения производительности.<br />
Таким образом, данные, требующие обработки, поступают в регистры процессора. Процессор производит над ними, в виде машинных слов, необходимые операции и возвращает полученные значения обратно программе, которая, в свою очередь, взаимодействует с пользователем.</p>

<p>Итак, если очень упрощенно и простыми словами описать, что происходит с программой после ее запуска, то, пожалуй, на этом можно остановиться. Также хочу отметить, что в данной статье я рассмотрел пример программы написанной на <strong>компилируемом</strong> языке программирования (например, C, C++). То есть сформированный после компиляции машинный код, будет зависим от процессора (платформы), для которого он, собственно, и подготовлен (скомпилирован). Для <strong>итерпретируемого</strong> языка программирования (например Python) все будет выглядеть несколько иначе. Сам шаг компиляции там отсутствует, как таковой. Инструкции не исполняются целевым процессором, а считываются и исполняются другой программой (которая обычно написана на языке целевого процессора). Но, об этом я, возможно, напишу в следующих статьях.</p>


</article>




<aside class="related">
  <h3>История постов</h3>
  <ul class="related-posts">
    
      <li>
        <a href="/2021/04/09/programming-universe8/">
          Вселенная программирования. Ключевые концепции ч5 - Абстракция данных.
          <small><time datetime="2021-04-09T00:00:00+03:00">09 Apr 2021</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2021/04/05/programming-universe7/">
          Вселенная программирования. Ключевые концепции ч4 - Темная сторона параллелизма.
          <small><time datetime="2021-04-05T00:00:00+03:00">05 Apr 2021</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2021/03/25/programming-universe6/">
          Вселенная программирования. Ключевые концепции ч3 - Параллелизм.
          <small><time datetime="2021-03-25T00:00:00+03:00">25 Mar 2021</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2021/02/15/programming-universe5/">
          Вселенная программирования. Ключевые концепции ч2 - Замыкания.
          <small><time datetime="2021-02-15T00:00:00+03:00">15 Feb 2021</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2021/02/02/programming-universe4/">
          Вселенная программирования. Ключевые концепции ч1.
          <small><time datetime="2021-02-02T00:00:00+03:00">02 Feb 2021</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2021/01/26/programming-universe3/">
          Вселенная программирования. Вычислительные модели – основные характеристики.
          <small><time datetime="2021-01-26T00:00:00+03:00">26 Jan 2021</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2021/01/10/programming-universe2/">
          Вселенная программирования. Глобальный взгляд на проектирование.
          <small><time datetime="2021-01-10T00:00:00+03:00">10 Jan 2021</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/12/25/programming-universe1/">
          Вселенная программирования. Введение.
          <small><time datetime="2020-12-25T00:00:00+03:00">25 Dec 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/11/15/imperativ_programm_function-call2/">
          Императивное программирование. Вызов функций ч2.
          <small><time datetime="2020-11-15T00:00:00+03:00">15 Nov 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/11/11/imperativ_programm_function-call/">
          Императивное программирование. Вызов функций, нити исполнения кода.
          <small><time datetime="2020-11-11T00:00:00+03:00">11 Nov 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/09/18/TG-bot-heroku-deploy/">
          Питонячий Телеграм-Бот, Yandex-API и диплой на Heroku.
          <small><time datetime="2020-09-18T00:00:00+03:00">18 Sep 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/07/28/FP-base-structs/">
          Функциональное программирование. Элементарные конструкции.
          <small><time datetime="2020-07-28T00:00:00+03:00">28 Jul 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/07/04/Functional-programming/">
          Функциональное программирование. Другой взгляд на мир.
          <small><time datetime="2020-07-04T00:00:00+03:00">04 Jul 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/06/14/Django-button_admin/">
          Django. Своя кнопка в админке.
          <small><time datetime="2020-06-14T00:00:00+03:00">14 Jun 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/05/28/Django-timezone/">
          Django. Время поговорить о времени.
          <small><time datetime="2020-05-28T00:00:00+03:00">28 May 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/05/08/Django-commands_and_pagination-%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/">
          Django. Пользовательские команды и Пагинация.
          <small><time datetime="2020-05-08T00:00:00+03:00">08 May 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/04/20/Django-scrf/">
          Django. Немного о SCRF.
          <small><time datetime="2020-04-20T00:00:00+03:00">20 Apr 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/04/15/Django-authorization/">
          Django. Авторизация и ограничение доступа.
          <small><time datetime="2020-04-15T00:00:00+03:00">15 Apr 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/04/13/Django-create-rest-api/">
          Django. Быстро прикручиваем REST API к проекту.
          <small><time datetime="2020-04-13T00:00:00+03:00">13 Apr 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/04/12/Django-REST/">
          Django. Знакомство с REST.
          <small><time datetime="2020-04-12T00:00:00+03:00">12 Apr 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/04/01/Django-stop-control/">
          Django. Стоп, контроль!
          <small><time datetime="2020-04-01T00:00:00+03:00">01 Apr 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/03/25/Django/">
          Django, приятно познакомиться.
          <small><time datetime="2020-03-25T00:00:00+03:00">25 Mar 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/02/17/go-to-stage-down/">
          Идем в машинное отделение.
          <small><time datetime="2020-02-17T00:00:00+03:00">17 Feb 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2020/01/23/start-point/">
          Точка старта. Когда ты понимаешь, что твои знания равны нулю)
          <small><time datetime="2020-01-23T00:00:00+03:00">23 Jan 2020</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2019/12/26/blog-building/">
          Pages.GitHub и Jekyll
          <small><time datetime="2019-12-26T00:00:00+03:00">26 Dec 2019</time></small>
        </a>
      </li>
    
      <li>
        <a href="/2019/12/25/my_first_steps/">
          Мой Блог. Начало.
          <small><time datetime="2019-12-25T00:00:00+03:00">25 Dec 2019</time></small>
        </a>
      </li>
    
  </ul>
</aside>

      </main>
	  
	
  

      <footer class="footer">
        <small><font style="color: gray; font-size: 16px; font-family: Arial">
		  <p><a href = 'https://vk.com/amelnikofcode'><font style="color: gray; font-size: 16px; font-family: Arial"> Мой профиль в ВК </font></a></p>
		  <p><a href = 'https://github.com/optima740'><font style="color: gray; font-size: 16px; font-family: Arial"> Мой профиль на GitHub</font></a></p>
		  &copy; <time datetime="2021-04-10T12:54:03+03:00">2021</time>
		</font>  
		  
        </small>
      </footer>
    </div>

    
  </body>
</html>
